#include<bits/stdc++.h>
using namespace std;
int n,i,j,k,l,m,o,c[32],d[32],e[32],a[100008];
char s[8],b[100008];
int main() {
    for(scanf("%d",&n); i++!=n; scanf("%d",a+i));
    if(scanf("%s",s),sort(s,s+strlen(s)),0==s[1]||s[0]!='*')
        for(i=0; n!=++i; b[i]=s[0]);
    else if(s[1]=='+') {
        for(i=1; i<=n&&a[i]<2; b[i++]='+');
        while(i<=n) {
            for(l=0,k=1,j=i; j<=n&&a[j]; b[j++]='*');
            while(a[--j]<2);
            for(; i<=j; k>>18?++i:(a[i]==1?0:c[l++]=i,k*=a[i++]));
            if(!(k>>18)) {
                for(d[l]=0,c[j=l]=c[l-1]+1; j--;)
                    for(m=1,d[k=j]=0; k!=l; o=(m*=a[c[k]])+c[k+1]-c[k]+d[k+1],
                            d[j]<=--o?(d[j]=o,e[j]=++k):++k);
                for(j=0; j!=l;)
                    for(m=c[j=e[j]],k=c[j-1]; k!=m; b[k++]='+');
            }
            for(b[i-1]='+'; i<=n&&a[i]<2; b[i++]='+');
        }
    } else
        for(i=j=0; i++!=n; j||a[i]?b[i-1]='*':(j=1,b[i-1]='-'));
    for(i=0; n!=++i; printf("%d%c",a[i],b[i]));
    printf("%d\n",a[n]),exit(0);
}